<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">

<!--
  libnkutils - Miscellaneous utilities

  Copyright Â© 2011-2017 Quentin "Sardem FF7" Glidic

  This file is part of libnkutils.

  libnkutils is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  libnkutils is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with libnkutils. If not, see <http://www.gnu.org/licenses/>.
-->
<refentry>
    <refsect2 id="nk-token-reference-description">
        <para>
            References use a shell-like format: <userinput>${<replaceable>reference-name</replaceable>}</userinput>.
            Each reference is resolved to a data that is substitued to the reference at the corresponding place in the string.
            The <replaceable>reference-name</replaceable> can be composed of alphabetic characters, dashes (<literal>'-'</literal>) and underscores (<literal>'_'</literal>).
        </para>
        <para>
            You can use an array-like syntax for some values: <userinput>${<replaceable>reference-name</replaceable>[<replaceable>key</replaceable>]}</userinput>.
            The <replaceable>key</replaceable> can be a name or a number depending on the data pointed by <replaceable>reference-name</replaceable>.
            You can use fallback values, substitute values or regexes on array members.
        </para>
        <para>
            You can use a fallback value if the data resolves to <literal>nothing</literal>.
            The syntax is: <userinput>${<replaceable>reference-name</replaceable>:-<replaceable>fallback-value</replaceable>}</userinput>.
        </para>
        <para>
            You can use a substitute value if the data resolves to <literal>something</literal>.
            The syntax is: <userinput>${<replaceable>reference-name</replaceable>:+<replaceable>substitute-value</replaceable>}</userinput>.
        </para>
        <para>
            You can replace parts of the data using the regex mechanism.
            The syntax is: <userinput>${<replaceable>reference-name</replaceable>/<replaceable>regex</replaceable>/<replaceable>replacement</replaceable>}</userinput>.
            The <replaceable>replacement</replaceable> part is optional (including the preceding forward slash). If it is omitted, matching parts of the data will simply be removed.
            You can repeat the <userinput>/<replaceable>regex</replaceable>/<replaceable>replacement</replaceable></userinput> part to replace as many patterns as you like.
            Each pattern is matched against the previous replacement so be careful in your order.
        </para>
        <para>Examples (with data and resolved string):</para>
        <variablelist>
            <varlistentry>
                <term><literal>"${name} is eating a ${fruit}."</literal></term>
                <listitem>
                    <para><varname>name</varname> is <literal>"Bob"</literal> and <varname>fruit</varname> is <literal>"pear"</literal>.</para>
                    <para>Resolves to: <literal>Bob is eating a pear.</literal></para>
                </listitem>
            </varlistentry>

            <varlistentry>
                <term><literal>"${name} is eating a ${fruit:-banana}."</literal></term>
                <listitem>
                    <para><varname>name</varname> is <literal>"Bob"</literal> and <varname>fruit</varname> is <literal>"pear"</literal>.</para>
                    <para>Resolves to: <literal>Bob is eating a pear.</literal></para>
                </listitem>
            </varlistentry>

            <varlistentry>
                <term><literal>"${name} is eating a ${fruit:-banana}."</literal></term>
                <listitem>
                    <para><varname>name</varname> is <literal>"Bob"</literal> and <varname>fruit</varname> is <literal>nothing</literal>.</para>
                    <para>Resolves to: <literal>Bob is eating a banana.</literal></para>
                </listitem>
            </varlistentry>

            <varlistentry>
                <term><literal>"${name} is eating a ${meat}${condiment:+ with }${condiment}."</literal></term>
                <listitem>
                    <para><varname>name</varname> is <literal>"Bob"</literal>, <varname>meat</varname> is <literal>"steak"</literal> and <varname>condiment</varname> is <literal>"mustard"</literal>.</para>
                    <para>Resolves to: <literal>Bob is eating a steak with mustard.</literal></para>
                </listitem>
            </varlistentry>

            <varlistentry>
                <term><literal>"${name} is eating a ${meat}${condiment:+ with }${condiment}."</literal></term>
                <listitem>
                    <para><varname>name</varname> is <literal>"Bob"</literal>, <varname>meat</varname> is <literal>"steak"</literal>and <varname>condiment</varname> is <literal>nothing</literal>.</para>
                    <para>Resolves to: <literal>Bob is eating a steak.</literal></para>
                </listitem>
            </varlistentry>

            <varlistentry>
                <term><literal>"${name} is eating a ${meat}${condiment/^/ with }."</literal></term>
                <listitem>
                    <para><varname>name</varname> is <literal>"Bob"</literal>, <varname>meat</varname> is <literal>"steak"</literal> and <varname>condiment</varname> is <literal>"mustard"</literal>.</para>
                    <para>Resolves to: <literal>Bob is eating a steak with mustard.</literal></para>
                </listitem>
            </varlistentry>

            <varlistentry>
                <term><literal>"${name} is eating a ${meat}${condiment/^/ with }."</literal></term>
                <listitem>
                    <para><varname>name</varname> is <literal>"Bob"</literal>, <varname>meat</varname> is <literal>"steak"</literal>and <varname>condiment</varname> is <literal>nothing</literal>.</para>
                    <para>Resolves to: <literal>Bob is eating a steak.</literal></para>
                </listitem>
            </varlistentry>

            <varlistentry>
                <term><literal>"${name} is eating a ${meat}${condiment/^/ with /$/ from France}."</literal></term>
                <listitem>
                    <para><varname>name</varname> is <literal>"Bob"</literal>, <varname>meat</varname> is <literal>"steak"</literal> and <varname>condiment</varname> is <literal>"mustard"</literal>.</para>
                    <para>Resolves to: <literal>Bob is eating a steak with mustard from France.</literal></para>
                </listitem>
            </varlistentry>
        </variablelist>
    </refsect2>

    <refsect2 id="nk-colour-type-description">
        <title>Colour strings</title>

        <para>
            The <type>colour string</type> format is borrowed from the <ulink url="http://www.w3.org/TR/2011/REC-css3-color-20110607/#numerical">CSS3 colour values</ulink>.
            Hexadecimal (<literal>#</literal>-prefixed) and decimal (<literal>rgb()</literal> format) RGB<phrase condition="nk_enable_colour_alpha">(A)</phrase> notations are supported.
        </para>

        <para>Here is a quick description:</para>
        <variablelist>
            <varlistentry>
                <term><userinput>#<replaceable>RR</replaceable><replaceable>GG</replaceable><replaceable>BB</replaceable><optional condition="nk_enable_colour_alpha"><replaceable>AA</replaceable></optional></userinput></term>
                <term><userinput>#<replaceable>R</replaceable><replaceable>G</replaceable><replaceable>B</replaceable><optional condition="nk_enable_colour_alpha"><replaceable>A</replaceable></optional></userinput></term>
                <listitem>
                    <para>Each value is an hexadecimal value in the <literal>0x00</literal>-<literal>0xff</literal> range.</para>
                    <para condition="nk_enable_colour_alpha">The alpha value is an extension of the CSS3 notation and is optional.</para>
                    <para>The single-letter version means <emphasis>duplicating</emphasis> the character (e.g. <literal>"#123"</literal> means <literal>"#112233"</literal>).</para>
                </listitem>
            </varlistentry>

            <varlistentry>
                <term><userinput>rgb(<replaceable>red</replaceable>, <replaceable>green</replaceable>, <replaceable>blue</replaceable>)</userinput></term>
                <term condition="nk_enable_colour_alpha"><userinput>rgba(<replaceable>red</replaceable>, <replaceable>green</replaceable>, <replaceable>blue</replaceable>, <replaceable>alpha</replaceable>)</userinput></term>
                <listitem>
                    <para>Each colour value can be an integer in the <literal>0</literal>-<literal>255</literal> range or a <type>percentage</type> value.</para>
                    <para condition="nk_enable_colour_alpha">The alpha value is a <type>floating point</type> value.</para>
                </listitem>
            </varlistentry>
        </variablelist>
    </refsect2>
</refentry>
